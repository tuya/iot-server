{"version":3,"sources":["../webpack/universalModuleDefinition","components/YDelAssetModal/index.less","components/YAssetSearch/index.less","public-path.js","lang/en.ts","lang/zh.ts","lang/index.ts","components/BModalForm/index.tsx","components/BAssetCascader/index.tsx","components/YAssetCascader/index.tsx","components/YAddAssetModal/index.tsx","components/YEditAssetModal/index.tsx","components/YDelAssetModal/index.tsx","components/YAssetSearch/index.tsx","pages/index.tsx","init.ts","App.tsx","index.tsx","pages/index.less"],"names":["root","factory","exports","module","define","amd","window","__POWERED_BY_QIANKUN__","__webpack_public_path__","__INJECTED_PUBLIC_PATH_BY_QIANKUN__","en","translation","title","table","column","name","id","childrenAssetCount","childrenDeviceCount","opt","row","edit","remove","search","placeholder","all","addAsset","btn","parentLabel","extra","error","fetch","max","required","editAsset","removeAsset","content","ok","cancel","hint","errorContent","ok2","assetCascader","zh","i18n","use","LanguageDetector","initReactI18next","init","resources","fallbackLng","interpolation","escapeValue","useForm","Form","layout","labelCol","span","wrapperCol","ModalForm","modalStatus","onConfirm","values","Promise","resolve","onCancel","children","showLoading","form","useState","confirmLoading","setConfirmLoading","destroyOnClose","visible","onOk","validateFields","then","resetFields","catch","info","console","log","preserve","BAssetCascader","defaultValue","loading","options","onChange","t","useTranslation","value","setValue","props","length","handleChange","selectedOptions","useEffect","style","marginLeft","spinning","width","expandTrigger","changeOnSelect","dropdownRender","menus","allowClear","getEntireTree","apiService","formatData2CascaderOptions","data","level","maxDeepth","Array","isArray","result","forEach","item","push","asset_id","label","asset_name","subAssets","undefined","getAssetPathByAssetId","assetList","assetId","path","i","subResult","YAssetCascader","setOptions","setLoading","setDefaultValue","history","useHistory","location","useLocation","list","query","autoHoldAssetId","autoSelectFirst","pathname","Item","AddAssetModal","showAddAssetModal","setShowAddAssetModal","configModal","status","onClick","type","icon","PlusOutlined","deviceName","fatherAssetId","err","rules","message","EditAssetModal","assetName","initialValue","hasDevice","asset","child_device_count","filter","delAssetFlow","Modal","className","styles","okText","showDelAssetCheckFail","confirm","cancelText","showDelAssetConfirmModal","searchAssetByName","SearchAsset","onSelect","searchAssetName","setSearchAssetName","searchSuggestion","setSearchSuggestion","align","ctrlLabel","dropdownMatchSelectWidth","onSearch","res","map","Search","getSubTree","formatTableData","AssetList","setList","page","setPage","pageSize","setPageSize","totalCount","setTotalCount","setAssetId","showEditAssetModal","setShowEditAssetModal","editAssetName","setEditAssetName","editAssetId","setEditAssetId","configEditAsset","tableFresh","setTableFresh","freshTable","state","tempList","fetchTableData","columns","dataIndex","tableCell","key","render","text","record","textBlue","textRed","background","justify","ctrlWrapper","rowKey","dataSource","pagination","current","defaultPageSize","total","pageNumber","onShowSizeChange","currentSize","nextPageSize","isEdit","needFresh","msgWhiteList","getI18n","locale","language","changeLanguage","configMethod","initGlobalConfig","headers","baseURL","onError","errorObj","code","msg","apiMethodName","localStorage","removeItem","mainHistory","includes","App","setGlobalState","micState","zhCN","enUS","base","container","ReactDOM","basename","querySelector","document","bootstrap","a","mount","lang","onGlobalStateChange","prev","unmount","unmountComponentAtNode"],"mappings":"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","file":"static/js/main.3cb498cd.chunk.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"asset-app-main\"] = factory();\n\telse\n\t\troot[\"asset-app-main\"] = factory();\n})(window, function() {\nreturn ","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal-content\":\"modal-content_YfMtW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ctrlLabel\":\"ctrlLabel_2qIzd\"};","/* eslint-disable no-undef */\nif (window.__POWERED_BY_QIANKUN__) {\n  __webpack_public_path__ = window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;\n}\n","const en = {\n  translation: {\n    title: 'Asset Management',\n    table: {\n      column: {\n        name: 'Asset name',\n        id: 'Asset ID',\n        childrenAssetCount: 'Number of child assets',\n        childrenDeviceCount: 'Number of devices',\n        opt: 'Operation',\n      },\n      row: {\n        edit: 'Edit',\n        remove: 'Delete',\n      },\n    },\n    search: {\n      title: 'Search for Asset',\n      placeholder: 'Enter asset name for a fuzzy search',\n      all: 'All',\n    },\n    addAsset: {\n      btn: 'Create asset',\n      title: 'Create asset',\n      parentLabel: 'Parent Asset',\n      extra:\n        'If there is no parent asset, the current asset will become a primary asset',\n      name: 'Asset name',\n      error: {\n        fetch: 'Operation failed!',\n        max: 'Asset name support up to 20 characters',\n        required: 'Required',\n      },\n    },\n    editAsset: {\n      title: 'Edit Asset',\n      name: 'Asset name',\n      error: {\n        fetch: 'Operation failed!',\n        max: 'Asset name support up to 20 characters',\n        required: 'Required',\n      },\n    },\n    removeAsset: {\n      title: 'Operation Confirm',\n      content:\n        'There is no device under the current asset and all sub-assets. Deleting the current asset will also delete all the related sub-assets. Are you sure you want to delete the asset? ',\n      ok: 'Confirm to delete',\n      cancel: 'Cancel',\n      hint: 'Note',\n      errorContent:\n        'There is a device under the current asset (or one of the sub-assets) that has not been removed, so the asset cannot be deleted',\n      ok2: 'Got it',\n    },\n    assetCascader: {\n      title: 'Asset Filter',\n      placeholder: 'Select an asset',\n    },\n  },\n};\n\nexport default en;\n","const zh = {\n  translation: {\n    title: '资产管理',\n    table: {\n      column: {\n        name: '资产名称',\n        id: '资产ID',\n        childrenAssetCount: '子资产数量',\n        childrenDeviceCount: '设备数量',\n        opt: '操作',\n      },\n      row: {\n        edit: '编辑',\n        remove: '删除',\n      },\n    },\n    search: {\n      title: '资产搜索',\n      placeholder: '输入资产名称模糊搜索',\n      all: '全部',\n    },\n    addAsset: {\n      btn: '创建资产',\n      title: '创建资产',\n      parentLabel: '父级资产',\n      extra: '若无父级资产，当前资产将成为一级资产',\n      name: '资产名称',\n      error: {\n        fetch: '操作失败!',\n        max: '资产名称最多输入20个字符',\n        required: '必填项',\n      },\n    },\n    editAsset: {\n      title: '编辑资产',\n      name: '资产名称',\n      error: {\n        fetch: '操作失败!',\n        max: '资产名称最多输入20个字符',\n        required: '必填项',\n      },\n    },\n    removeAsset: {\n      title: '操作确认',\n      content:\n        '当前资产及所有子资产下没有设备，删除当前资产会同时删除资产下的所有子资产，确定要删除资产吗？',\n      ok: '确认删除',\n      cancel: '取消',\n      hint: '提示',\n      errorContent: '当前资产（或子资产）下有设备未移除，无法删除资产',\n      ok2: '知道了',\n    },\n    assetCascader: {\n      title: '资产筛选',\n      placeholder: '资产选择',\n    },\n  },\n};\n\nexport default zh;\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\nimport en from './en';\nimport zh from './zh';\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  .init({\n    resources: { 'en-US': en, 'zh-CN': zh },\n    fallbackLng: 'zh-CN',\n    interpolation: {\n      escapeValue: false,\n    },\n  });\n","/**\n * 集成form的modal\n */\nimport { useState } from 'react';\nimport { Modal, Form } from 'antd';\n\nconst { useForm } = Form;\n\ninterface IProps {\n  modalStatus: boolean;\n  title: string;\n  children: React.ReactNode;\n  onConfirm: (values: any) => Promise<boolean>;\n  onCancel?: () => void;\n  showLoading?: boolean;\n}\n\nconst layout = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 16 },\n};\n\nconst ModalForm = ({\n  modalStatus = false,\n  onConfirm = (values: any) => {\n    return Promise.resolve(true);\n  },\n  onCancel = () => {},\n  title = '',\n  children,\n  showLoading = false,\n}: IProps) => {\n  const [form] = useForm();\n  const [confirmLoading, setConfirmLoading] = useState(false);\n\n  return (\n    <Modal\n      destroyOnClose\n      visible={modalStatus}\n      title={title}\n      confirmLoading={confirmLoading}\n      onCancel={onCancel}\n      onOk={() => {\n        form\n          .validateFields()\n          .then((values) => {\n            setConfirmLoading(true);\n            onConfirm(values).then(() => {\n              setConfirmLoading(false);\n              form.resetFields();\n            });\n          })\n          .catch((info) => {\n            console.log('Validate Failed:', info);\n          });\n      }}\n    >\n      <Form form={form} preserve={false} {...layout}>\n        {children}\n      </Form>\n    </Modal>\n  );\n};\n\nexport default ModalForm;\n","/**\n * 资产级联选择\n */\nimport { useEffect, useState } from 'react';\nimport { Cascader, Space, Spin } from 'antd';\nimport { CascaderValueType, CascaderOptionType } from 'antd/lib/cascader';\nimport { Asset } from '@tuya/connector';\nimport { useTranslation } from 'react-i18next';\n\ninterface IProps {\n  defaultValue: string[];\n  loading: boolean;\n  title: string;\n  options: Asset[];\n  onChange?: (\n    value: CascaderValueType,\n    selectedOptions?: CascaderOptionType[],\n  ) => void;\n}\n\nconst BAssetCascader = ({\n  defaultValue,\n  loading,\n  title = '',\n  options = [],\n  onChange,\n}: IProps) => {\n  const { t } = useTranslation();\n  const [value, setValue] = useState<CascaderValueType>([]);\n\n  const props: { [key: string]: any } = {};\n  if (defaultValue.length) {\n    props.defaultValue = defaultValue;\n  }\n\n  const handleChange = (\n    value: CascaderValueType,\n    selectedOptions: CascaderOptionType[],\n  ) => {\n    setValue(value);\n    onChange && onChange(value, selectedOptions);\n  };\n\n  useEffect(() => {\n    setValue(defaultValue);\n  }, [defaultValue]);\n\n  if (title) {\n    return (\n      <Space>\n        <span style={{ marginLeft: 15 }}>{title}</span>\n        <Spin spinning={loading}>\n          <Cascader\n            value={value}\n            style={{ width: '100%' }}\n            placeholder={t('assetCascader.placeholder')}\n            options={options}\n            onChange={handleChange}\n            expandTrigger=\"hover\"\n            changeOnSelect\n            dropdownRender={(menus) => {\n              return <Spin spinning={loading}>{menus}</Spin>;\n            }}\n            allowClear={false}\n          />\n        </Spin>\n      </Space>\n    );\n  }\n  return (\n    <Spin spinning={loading}>\n      <Cascader\n        {...props}\n        style={{ width: '100%' }}\n        placeholder={t('assetCascader.placeholder')}\n        options={options}\n        onChange={handleChange}\n        expandTrigger=\"hover\"\n        changeOnSelect\n        dropdownRender={(menus) => {\n          return <Spin spinning={loading}>{menus}</Spin>;\n        }}\n        allowClear={false}\n      />\n    </Spin>\n  );\n};\n\nexport default BAssetCascader;\n","/**\n * 资产级联业务\n */\nimport { useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { CascaderValueType, CascaderOptionType } from 'antd/lib/cascader';\nimport { apiService, AssetDeep } from '@tuya/connector';\nimport BAssetCascader from '../BAssetCascader';\n\nconst { getEntireTree } = apiService;\n\ninterface IProps {\n  autoHoldAssetId?: boolean;\n  autoSelectFirst?: boolean;\n  title: string;\n  onChange?: (\n    value: CascaderValueType,\n    selectedOptions?: CascaderOptionType[],\n  ) => void;\n  maxDeepth: number;\n}\n\nconst formatData2CascaderOptions = (\n  data: Array<AssetDeep>,\n  level: number,\n  maxDeepth: number,\n) => {\n  if (!Array.isArray(data)) {\n    return [];\n  }\n  const result: any[] = [];\n  data.forEach((item) => {\n    result.push({\n      value: item.asset_id,\n      label: item.asset_name,\n      children:\n        item?.subAssets.length && level < maxDeepth\n          ? formatData2CascaderOptions(item.subAssets, level + 1, maxDeepth)\n          : undefined,\n    });\n  });\n\n  return result;\n};\n\nconst getAssetPathByAssetId = (assetList: any[], assetId: string) => {\n  const path: string[] = [];\n\n  for (let i = 0; i < assetList.length; i++) {\n    const item = assetList[i];\n    if (item.value === assetId) {\n      return [item.value];\n    }\n    if (item.children) {\n      const subResult = getAssetPathByAssetId(item.children, assetId);\n      if (subResult.length) {\n        path.push(item.value, ...subResult);\n      }\n    }\n  }\n\n  return path;\n};\n\nconst YAssetCascader = (props: IProps) => {\n  const [options, setOptions] = useState<AssetDeep[]>([]);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [defaultValue, setDefaultValue] = useState<string[]>([]);\n  const history = useHistory();\n  const location = useLocation();\n\n  useEffect(() => {\n    setLoading(true);\n    // 拉取整棵树\n    getEntireTree()\n      .then((result) => {\n        setLoading(false);\n        const list = formatData2CascaderOptions(result, 1, props.maxDeepth);\n        setOptions(list);\n        // 获取query中的assetId\n        const { assetId } = (location as any).query;\n        if (props.autoHoldAssetId && assetId) {\n          // 有指定assetId, 为级联赋予默认值\n          const path = getAssetPathByAssetId(list, assetId);\n          if (path.length) {\n            setDefaultValue(path);\n            // 在列表中找到了assetId，直接使用，不关心路径\n            props.onChange && props.onChange([assetId]);\n          }\n        } else if (props.autoSelectFirst && list.length) {\n          setDefaultValue([list[0].value]);\n          history.push({\n            pathname: location.pathname,\n            query: { assetId: list[0].value },\n          } as any);\n          props.onChange && props.onChange([list[0].value]);\n        }\n      })\n      .catch(() => {\n        setLoading(false);\n      });\n  }, []);\n\n  return (\n    <BAssetCascader\n      defaultValue={defaultValue}\n      loading={loading}\n      {...props}\n      options={options}\n      onChange={(value: any) => {\n        if (value?.length) {\n          if (props.autoHoldAssetId) {\n            const id = value[value.length - 1];\n            history.push({\n              pathname: location.pathname,\n              query: {\n                assetId: id,\n              },\n            } as any);\n          }\n          props.onChange && props.onChange(value);\n        }\n      }}\n    />\n  );\n};\n\nexport default YAssetCascader;\n","/**\n * 添加资产\n */\nimport { useState } from 'react';\nimport { Form, Input, Button } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { apiService } from '@tuya/connector';\n\nimport ModalForm from '@/components/BModalForm';\nimport YAssetCascader from '@/components/YAssetCascader';\nimport { useTranslation } from 'react-i18next';\n\nconst { addAsset } = apiService;\n\nconst { Item } = Form;\n\ninterface IProps {\n  onConfirm: () => void;\n}\n\nconst AddAssetModal = ({ onConfirm = () => {} }: IProps) => {\n  const { t } = useTranslation();\n  // addAssetModal state\n  const [showAddAssetModal, setShowAddAssetModal] = useState<boolean>(false);\n\n  const configModal = (status = false) => {\n    setShowAddAssetModal(status);\n  };\n\n  return (\n    <>\n      <Button\n        onClick={() => {\n          configModal(true);\n        }}\n        type=\"primary\"\n        icon={<PlusOutlined />}\n      >\n        {t('addAsset.btn')}\n      </Button>\n      <ModalForm\n        title={t('addAsset.title')}\n        modalStatus={showAddAssetModal}\n        onConfirm={(values) => {\n          const { deviceName, fatherAssetId } = values;\n          const id = Array.isArray(fatherAssetId)\n            ? fatherAssetId[fatherAssetId.length - 1]\n            : '';\n\n          return addAsset(deviceName, id)\n            .then(() => {\n              configModal();\n              onConfirm();\n              return true;\n            })\n            .catch((err) => {\n              console.error(err);\n              return true;\n            });\n        }}\n        onCancel={() => {\n          configModal();\n        }}\n      >\n        <Item\n          label={t('addAsset.parentLabel')}\n          extra={t('addAsset.extra')}\n          name=\"fatherAssetId\"\n        >\n          <YAssetCascader\n            title=\"\"\n            maxDeepth={4}\n            autoSelectFirst={false}\n            autoHoldAssetId={false}\n          />\n        </Item>\n        <Item\n          label={t('addAsset.name')}\n          name=\"deviceName\"\n          rules={[\n            { required: true, message: t('addAsset.error.required') },\n            {\n              max: 20,\n              message: t('addAsset.error.max'),\n            },\n          ]}\n        >\n          <Input />\n        </Item>\n      </ModalForm>\n    </>\n  );\n};\n\nexport default AddAssetModal;\n","/**\n * 编辑资产\n */\nimport { Form, Input } from 'antd';\nimport { apiService } from '@tuya/connector';\nimport { useTranslation } from 'react-i18next';\nimport ModalForm from '@/components/BModalForm';\n\nconst { editAsset } = apiService;\n\nconst { Item } = Form;\n\ninterface IProps {\n  isEdit: boolean;\n  modalStatus: boolean;\n  assetId: string;\n  name: string;\n  onConfirm: (needFresh: boolean) => void;\n}\n\nconst EditAssetModal = ({\n  modalStatus = false,\n  onConfirm = () => {},\n  assetId,\n  name,\n}: IProps) => {\n  const { t } = useTranslation();\n\n  return (\n    <ModalForm\n      title={t('editAsset.title')}\n      modalStatus={modalStatus}\n      onConfirm={(values) => {\n        const { assetName } = values;\n        return editAsset(assetId, assetName)\n          .then(() => {\n            onConfirm(true);\n            return true;\n          })\n          .catch((err) => {\n            // message.error(___.assets.editAsset.error.fetch);\n            console.error(err);\n            return true;\n          });\n      }}\n      onCancel={() => {\n        onConfirm(false);\n      }}\n    >\n      <Item\n        initialValue={name}\n        label={t('editAsset.name')}\n        name=\"assetName\"\n        rules={[\n          {\n            required: true,\n            message: t('editAsset.error.required'),\n          },\n          {\n            max: 20,\n            message: t('editAsset.error.max'),\n          },\n        ]}\n      >\n        <Input />\n      </Item>\n    </ModalForm>\n  );\n};\n\nexport default EditAssetModal;\n","/**\n * 删除弹窗\n */\nimport { Modal } from 'antd';\nimport { AssetDeep, removeAsset } from '@tuya/connector/dist/lib/apis';\nimport styles from './index.less';\n\nexport const showDelAssetConfirmModal = (t: any, onOk: () => void) => {\n  Modal.confirm({\n    icon: null,\n    title: t('removeAsset.title'),\n    content: <span className={styles['modal-content']}>{ t('removeAsset.content')}</span>,\n    okText: t('removeAsset.ok'),\n    cancelText: t('removeAsset.cancel'),\n    onOk,\n  });\n};\n\nexport const showDelAssetCheckFail = (t: any) => {\n  Modal.info({\n    title: t('removeAsset.hint'),\n    content: (\n      <span className={styles['modal-content']}>\n        {t('removeAsset.errorContent')}\n      </span>\n    ),\n    okText: t('removeAsset.ok2'),\n  });\n};\n\nconst hasDevice = (asset: AssetDeep) => {\n  const currentDeviceCount = asset.child_device_count;\n  if (currentDeviceCount > 0) {\n    return true;\n  }\n  if (asset.subAssets?.length) {\n    const results = asset.subAssets.filter((item) => {\n      return hasDevice(item);\n    });\n    if (results.length) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * 删除资产流程\n */\nexport const delAssetFlow = (asset: AssetDeep, t: any) => {\n  return new Promise((resolve) => {\n    if (hasDevice(asset)) {\n      showDelAssetCheckFail(t);\n      resolve(false);\n      return;\n    }\n    showDelAssetConfirmModal(t, () => {\n      return removeAsset(asset.asset_id).then(() => {\n        resolve(true);\n      });\n    });\n  });\n};\n\nexport default delAssetFlow;\n","/**\n * 搜索asset\n */\nimport { useEffect, useState } from 'react';\nimport { AutoComplete, Input, Row, Col } from 'antd';\nimport { apiService } from '@tuya/connector';\n\nimport styles from './index.less';\nimport { useTranslation } from 'react-i18next';\n\nconst { searchAssetByName } = apiService;\n\ninterface IProps {\n  onSelect: (value: string) => void;\n}\n\nconst SearchAsset = ({ onSelect }: IProps) => {\n  const { t } = useTranslation();\n  const [searchAssetName, setSearchAssetName] = useState<string>('');\n  const [searchSuggestion, setSearchSuggestion] = useState<Array<any>>([]);\n\n  useEffect(() => {}, []);\n  return (\n    <Row align=\"middle\">\n      <Col>\n        <label className={styles.ctrlLabel}>{t('search.title')}</label>\n      </Col>\n      <Col>\n        <AutoComplete\n          dropdownMatchSelectWidth={252}\n          style={{\n            width: 300,\n          }}\n          options={searchSuggestion}\n          value={searchAssetName}\n          onSelect={(value, options) => {\n            onSelect(value);\n            setSearchAssetName(options.label as string);\n          }}\n          onSearch={(value) => {\n            searchAssetByName(value).then((res) => {\n              const options = res.map((item) => {\n                return {\n                  label: item.asset_name,\n                  value: item.asset_id,\n                };\n              });\n\n              // if (value === '') {\n              //   options.unshift({\n              //     label: t('search.all'),\n              //     value: '-1',\n              //   });\n              // }\n              setSearchSuggestion(options);\n            });\n            setSearchAssetName(value);\n          }}\n        >\n          <Input.Search placeholder={t('search.placeholder')} />\n        </AutoComplete>\n      </Col>\n    </Row>\n  );\n};\n\nexport default SearchAsset;\n","/**\n * 资产列表\n */\nimport { useEffect, useState } from 'react';\nimport { Table, Row, Col, Space } from 'antd';\nimport { useTranslation } from 'react-i18next';\n\nimport { apiService, AssetDeep } from '@tuya/connector';\n\nimport AddAssetModal from '@/components/YAddAssetModal';\nimport EditAssetModal from '@/components/YEditAssetModal';\nimport delAssetFlow from '@/components/YDelAssetModal';\nimport SearchAsset from '@/components/YAssetSearch';\n\nimport styles from './index.less';\n\nconst { getSubTree } = apiService;\n\nconst formatTableData = (data: AssetDeep[]) => {\n  const result: any[] = [];\n  data.forEach((item) => {\n    if (Array.isArray(item.subAssets) && item.subAssets.length) {\n      result.push({\n        ...item,\n        children: formatTableData(item.subAssets),\n      });\n      return;\n    }\n    result.push({\n      ...item,\n    });\n  });\n\n  return result;\n};\n\nconst AssetList = () => {\n  const { t } = useTranslation();\n  const [list, setList] = useState<any[]>([]);\n  const [page, setPage] = useState(1);\n  const [pageSize, setPageSize] = useState(20);\n  const [totalCount, setTotalCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n\n  const fetchTableData = (assetId: string = '-1') => {\n    setLoading(true);\n    getSubTree(assetId)\n      .then((res) => {\n        setLoading(false);\n\n        let tempList: AssetDeep[] = [];\n        if (assetId !== '-1' && res.asset_id) {\n          tempList = [res];\n        } else {\n          tempList = res.subAssets;\n        }\n        setList(formatTableData(tempList));\n        setTotalCount(tempList.length);\n      })\n      .catch(() => {\n        // message.error('获取资产失败!');\n        setLoading(false);\n        setList([]);\n        setTotalCount(0);\n      });\n  };\n\n  // assetId state\n  const [assetId, setAssetId] = useState<string>('-1');\n\n  // editAssetModal state\n  const [showEditAssetModal, setShowEditAssetModal] = useState<boolean>(false);\n  const [editAssetName, setEditAssetName] = useState<string>('');\n  const [editAssetId, setEditAssetId] = useState<string>('');\n\n  const configEditAsset = (\n    showEditAssetModal = false,\n    assetName = '',\n    assetId = '',\n  ) => {\n    setShowEditAssetModal(showEditAssetModal);\n    setEditAssetName(assetName);\n    setEditAssetId(assetId);\n  };\n\n  // fresh table list state\n  const [tableFresh, setTableFresh] = useState(0);\n\n  const freshTable = () => {\n    setTableFresh((state) => {\n      return state + 1;\n    });\n  };\n\n  useEffect(() => {\n    fetchTableData(assetId);\n  }, [tableFresh, assetId]);\n\n  const columns: Array<any> = [\n    {\n      title: t('table.column.name'),\n      dataIndex: 'asset_name',\n      width: '20%',\n      className: styles.tableCell,\n    },\n    {\n      key: 'asset_id',\n      title: t('table.column.id'),\n      dataIndex: 'asset_id',\n      className: styles.tableCell,\n    },\n    {\n      title: t('table.column.childrenAssetCount'),\n      dataIndex: 'child_asset_count',\n      className: styles.tableCell,\n    },\n    {\n      title: t('table.column.childrenDeviceCount'),\n      dataIndex: 'child_device_count',\n      className: styles.tableCell,\n    },\n    {\n      title: t('table.column.opt'),\n      dataIndex: 'opt',\n      width: '20%',\n      align: 'center',\n      render: (text: any, record: any) => {\n        return (\n          <Space>\n            <span\n              onClick={() => {\n                configEditAsset(true, record.asset_name, record.asset_id);\n              }}\n              className={styles.textBlue}\n            >\n              {t('table.row.edit')}\n            </span>\n            <span\n              onClick={() => {\n                return delAssetFlow(\n                  record,\n                  t,\n                ).then((res) => {\n                  res && freshTable();\n                });\n              }}\n              className={styles.textRed}\n            >\n              {t('table.row.remove')}\n            </span>\n          </Space>\n        );\n      },\n    },\n  ];\n\n  return (\n    <div className={styles.background}>\n      <Row justify=\"space-between\" className={styles.ctrlWrapper}>\n        <Col>\n          <SearchAsset\n            onSelect={(value) => {\n              setAssetId(value);\n            }}\n          />\n        </Col>\n        <Col>\n          <AddAssetModal\n            onConfirm={() => {\n              freshTable();\n            }}\n          />\n        </Col>\n      </Row>\n      <Table\n        loading={loading}\n        columns={columns}\n        rowKey={(record: any) => record.asset_id}\n        dataSource={list}\n        pagination={{\n          current: page,\n          defaultPageSize: pageSize,\n          pageSize,\n          total: totalCount,\n          onChange: (pageNumber) => {\n            setPage(pageNumber);\n          },\n          onShowSizeChange: (currentSize, nextPageSize) => {\n            setPageSize(nextPageSize);\n          },\n        }}\n      />\n      <EditAssetModal\n        isEdit\n        modalStatus={showEditAssetModal}\n        name={editAssetName}\n        assetId={editAssetId}\n        onConfirm={(needFresh) => {\n          configEditAsset();\n          needFresh && freshTable();\n        }}\n      />\n    </div>\n  );\n};\n\nexport default AssetList;\n","import { getI18n } from 'react-i18next';\nimport { configMethod } from '@tuya/connector';\nimport { message } from 'antd';\nimport { mainHistory } from './index';\n\nconst init = () => {\n  const msgWhiteList = ['getDevicesInfoByAssetId'];\n  const i18n = getI18n();\n  const locale = i18n.language;\n  if (locale === 'zh-CN') {\n    i18n.changeLanguage(locale);\n  } else {\n    i18n.changeLanguage('en-US');\n  }\n\n  configMethod.initGlobalConfig({\n    headers: {\n      'Accept-Language': locale === 'zh-CN' ? locale : 'en-US',\n    },\n    baseURL: '/api',\n    onError: (errorObj) => {\n      const { code, msg, apiMethodName } = errorObj;\n\n      if (code === '1010') {\n        localStorage.removeItem('_USERNAME');\n        mainHistory.push('/login');\n        return;\n      }\n\n      // 需屏蔽的方法\n      if (msgWhiteList.includes(apiMethodName)) {\n        return;\n      }\n\n      message.error(msg);\n    },\n  });\n};\n\nexport default init;\n","import {ConfigProvider} from 'antd';\nimport {getI18n} from 'react-i18next';\nimport enUS from 'antd/lib/locale/en_US';\nimport zhCN from 'antd/lib/locale/zh_CN';\n\nimport { IProps } from '.';\nimport './App.css';\nimport Page from '@/pages';\nimport init from '@/init';\n\nfunction App(props: IProps) {\n  init();\n  const i18n = getI18n();\n  const locale = i18n.language === 'zh-CN' ? zhCN : enUS;\n\n  return <ConfigProvider locale={locale}>\n    <Page />\n  </ConfigProvider>\n  ;\n}\n\nexport default App;\n","import React from 'react';\nimport './public-path';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport { getI18n } from 'react-i18next';\nimport './index.css';\nimport './lang';\nimport App from './App';\n\n\nexport interface IProps {\n  base?: string;\n  container?: any;\n  onGlobalStateChange?: any;\n  setGlobalState?: (state) => void;\n  mainHistory?: any;\n  lang?: string;\n}\n\nexport let setGlobalState;\nexport let micState;\nexport let mainHistory;\n\nfunction render(props: IProps) {\n  const { base, container } = props;\n  ReactDOM.render(\n    <BrowserRouter basename={window.__POWERED_BY_QIANKUN__ ? base : '/'}>\n      <App {...props} />\n    </BrowserRouter>,\n    container\n      ? container.querySelector('#root')\n      : document.querySelector('#root'),\n  );\n}\n\nif (!window.__POWERED_BY_QIANKUN__) {\n  render({});\n}\n\nexport async function bootstrap() {\n  console.log('资产微应用启动');\n}\n\nexport async function mount(props: IProps) {\n  console.log('挂载资产微应用', props);\n  getI18n().changeLanguage(props.lang);\n  mainHistory = props.mainHistory;\n  render(props);\n  props.onGlobalStateChange((state, prev) => {\n    console.log('资产微应用', state, prev);\n    micState = state;\n  }, true);\n  setGlobalState = (state) => {\n    props.setGlobalState({ ...micState, ...state });\n  };\n}\n\nexport async function unmount(props: IProps) {\n  const { container } = props;\n  ReactDOM.unmountComponentAtNode(\n    container\n      ? container.querySelector('#root')\n      : document.querySelector('#root'),\n  );\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"background_slzll\",\"ctrlWrapper\":\"ctrlWrapper_3uAda\",\"ctrlLabel\":\"ctrlLabel_2MgNX\",\"editInputHint\":\"editInputHint_VTmLk\",\"tableCell\":\"tableCell_j9K89\",\"textBlue\":\"textBlue_3T0i2\",\"textRed\":\"textRed_31INU\"};"],"sourceRoot":""}